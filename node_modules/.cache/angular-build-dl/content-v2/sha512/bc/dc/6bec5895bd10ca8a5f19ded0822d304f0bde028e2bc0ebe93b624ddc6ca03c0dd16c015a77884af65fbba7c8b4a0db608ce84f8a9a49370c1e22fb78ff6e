!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{XfGX:function(n,a,r){"use strict";r.r(a),r.d(a,"DataUploadModule",function(){return j});var i=r("ofXK"),o=r("tE69"),c=r("3Pt+"),s=r("tyNb"),l=r("tyVc"),u=r("ZOsW"),d=r("njyG"),b=r("AytR"),p=r("IheW"),f=r("PSD3"),h=r.n(f),g=r("fXoL"),v=r("EAui"),m=r("nkOh"),y=r("Txdn"),w=r("ltvU"),I=r("xNm2"),O=r("IYwT");function R(e,t){1&e&&(g.Rb(0,"div",2),g.Rb(1,"div",3),g.Ic(2,"Loading..."),g.Qb(),g.Qb())}function T(e,t){if(1&e&&(g.Rb(0,"div",30),g.Rb(1,"div",31),g.Ic(2),g.Qb(),g.Qb()),2&e){var n=g.dc(2);g.yb(1),g.Ec("width: ",n.progress,"%;"),g.yb(1),g.Kc(" ",n.progress,"%")}}function _(e,t){if(1&e&&(g.Rb(0,"th"),g.Ic(1),g.Qb()),2&e){var n=g.dc().$implicit;g.yb(1),g.Jc(n.colname)}}function Q(e,t){if(1&e&&(g.Pb(0),g.Gc(1,_,2,1,"th",34),g.Ob()),2&e){var n=t.$implicit;g.yb(1),g.jc("ngIf",n.is_view)}}function x(e,t){if(1&e&&(g.Pb(0),g.Rb(1,"td",35),g.Ic(2),g.Qb(),g.Ob()),2&e){var n=g.dc().$implicit,a=g.dc().$implicit;g.yb(1),g.jc("ngClass",1===a.with_error?"has_error":""),g.yb(1),g.Jc(a[n])}}function k(e,t){if(1&e&&(g.Pb(0),g.Gc(1,x,3,2,"ng-container",34),g.Ob()),2&e){var n=t.$implicit;g.yb(1),g.jc("ngIf","with_error"!==n)}}function L(e,t){if(1&e&&(g.Rb(0,"tr"),g.Gc(1,k,2,1,"ng-container",33),g.Qb()),2&e){var n=t.$implicit,a=g.dc(3);g.yb(1),g.jc("ngForOf",a._object.keys(n))}}function S(e,t){if(1&e&&(g.Rb(0,"table",32),g.Rb(1,"thead"),g.Rb(2,"tr"),g.Gc(3,Q,2,1,"ng-container",33),g.Qb(),g.Qb(),g.Rb(4,"tbody"),g.Gc(5,L,2,1,"tr",33),g.Qb(),g.Qb()),2&e){var n=g.dc(2);g.yb(3),g.jc("ngForOf",n.tableOutput),g.yb(2),g.jc("ngForOf",n.returnOutput)}}function M(e,t){if(1&e){var n=g.Sb();g.Rb(0,"div",4),g.Rb(1,"div",5),g.Rb(2,"div",6),g.Rb(3,"h6"),g.Ic(4,"Data Upload"),g.Qb(),g.Qb(),g.Rb(5,"div",7),g.Rb(6,"div",8),g.Rb(7,"div",9),g.Rb(8,"div",10),g.Rb(9,"label",11),g.Ic(10,"Data Upload"),g.Qb(),g.Rb(11,"ng-select",12),g.bc("ngModelChange",function(e){return g.xc(n),g.dc().selectedData=e})("change",function(){return g.xc(n),g.dc().onChange()}),g.Qb(),g.Qb(),g.Qb(),g.Rb(12,"div",13),g.Rb(13,"div",10),g.Rb(14,"label",11),g.Ic(15,"\xa0"),g.Qb(),g.Rb(16,"input",14,15),g.bc("change",function(e){return g.xc(n),g.dc().uploadFile(e)}),g.Qb(),g.Rb(18,"div",16),g.bc("click",function(e){return g.xc(n),g.dc().openFileBrowser(e)}),g.Mb(19,"input",17),g.Rb(20,"span",18),g.Rb(21,"button",19),g.Mb(22,"i",20),g.Ic(23," Upload"),g.Qb(),g.Ic(24," \xa0 "),g.Qb(),g.Qb(),g.Gc(25,T,3,4,"div",21),g.Qb(),g.Qb(),g.Rb(26,"div",22),g.Rb(27,"div",10),g.Rb(28,"label",11),g.Ic(29,"\xa0"),g.Qb(),g.Rb(30,"div",10),g.Rb(31,"button",23),g.bc("click",function(){return g.xc(n),g.dc().exportTemplate()}),g.Mb(32,"i",24),g.Ic(33," Download Template"),g.Qb(),g.Ic(34,"\xa0 "),g.Rb(35,"button",25),g.bc("click",function(){return g.xc(n),g.dc().submit()}),g.Mb(36,"i",26),g.Ic(37," Save "),g.Qb(),g.Qb(),g.Qb(),g.Qb(),g.Qb(),g.Mb(38,"hr"),g.Rb(39,"div",27),g.Rb(40,"p",28),g.Ic(41),g.Qb(),g.Gc(42,S,6,2,"table",29),g.Qb(),g.Qb(),g.Qb(),g.Qb()}if(2&e){var a=g.dc();g.yb(11),g.jc("items",a.uploadList)("ngModel",a.selectedData),g.yb(14),g.jc("ngIf",a.progress>0),g.yb(16),g.Jc(a.errorText),g.yb(1),g.jc("ngIf",a.showTable)}}var F,D,U=[{path:"",component:o.a,children:[{path:"",redirectTo:"data-upload",pathMatch:"full"},{path:"data-upload",component:(F=function(){function n(t,a,r,i,o,c,s){var l=this;e(this,n),this.permissionManagementService=t,this.dataUploadManagementService=a,this.http=r,this.handler=i,this.tenantDefaultService=o,this.userManagementService=c,this.filingManagementService=s,this.uri=b.a.exportUrl,this.isLoading=!0,this.showTable=!0,this.uploadList=[],this.headerList=[],this.tableOutput=[],this.selectedOutput=[],this.returnOutput=[],this.progress=0,this._object=Object,this.uploadFile=function(e){e.target.files.length&&document.querySelector("#fileUploadInputExample + .input-group .file-upload-info").setAttribute("value",e.target.files[0].name);var t=e.target.files;0!==t.length&&l.uploadFiles(t)}}var a,r,i;return a=n,(r=[{key:"ngOnInit",value:function(){var e=this;this.http=new p.c(this.handler),this.permissionManagementService.dataUploadAccess(sessionStorage.getItem("al")).subscribe(function(t){e.uploadList=t,e.isLoading=!1},function(e){console.log(e.error)})}},{key:"openFileBrowser",value:function(e){e.preventDefault(),document.querySelector("#fileUploadInputExample").click(),e.target.files&&e.target.files[0]&&(new FileReader).readAsDataURL(e.target.files[0])}},{key:"onChange",value:function(){var e=this;this.tableOutput=[],this.headerList=[],this.returnOutput=[],this.dataUploadManagementService.uploadHeader(this.selectedData).subscribe(function(t){e.tableOutput=t,e.headerList=t,e.showTable=!0},function(e){console.log(e.error)})}},{key:"exportTemplate",value:function(){var e=this,t=this.uploadList.filter(function(t){return t.data_upload_id===e.selectedData})[0];this.dataUploadManagementService.downloadTemplate(t.export).subscribe(function(t){window.location.href=e.uri+t.response},function(e){console.log(e.error)})}},{key:"uploadFiles",value:function(e){var t=this;this.errorText="";var n=this.uploadList.filter(function(e){return e.data_upload_id===t.selectedData})[0];this.http=new p.c(this.handler);var a=e[0],r=new FormData;r.append("formfile",a,a.name),this.http.post(this.uri+n.upload+"?created_by="+sessionStorage.getItem("u")+"&dropdown_id="+this.selectedData+"&series_code="+sessionStorage.getItem("sc"),r,{reportProgress:!0,observe:"events"}).subscribe(function(e){e.type===p.e.UploadProgress?t.progress=Math.round(100*e.loaded/e.total):e.type===p.e.Response&&(h.a.fire("Ok!","Upload successful!","success"),t.dataUploadManagementService.uploadDetail(t.selectedData).subscribe(function(e){var n=JSON.parse(e.toString());t.selectedOutput=JSON.parse(e.toString());for(var a=function(){var e=t.tableOutput[r].columns,a=t.tableOutput[r].is_view;"with_error"!==e&&(a||n.forEach(function(t){delete t[e]}))},r=0;r<t.tableOutput.length;r++)a();t.returnOutput=n,t.returnOutput.filter(function(e){return 1===e.with_error}).length>0&&(t.errorText="There are "+t.returnOutput.filter(function(e){return 1===e.with_error}).length+" rows error on your file please review.")},function(e){console.log(e.error)}))})}},{key:"submit",value:function(){var e=this,t="Are you sure?";this.returnOutput.filter(function(e){return 1===e.with_error}).length>0&&(t="Are you sure sure you want to continue? There are "+this.returnOutput.filter(function(e){return 1===e.with_error}).length+" rows that will not be saved."),h.a.fire({title:t,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",showLoaderOnConfirm:!0}).then(function(t){t.isConfirmed&&h.a.fire({title:"Please Wait !",allowOutsideClick:!1,onBeforeOpen:function(){h.a.showLoading();var t=e.uploadList.filter(function(t){return t.data_upload_id===e.selectedData})[0],n={series_code:sessionStorage.getItem("sc"),created_by:sessionStorage.getItem("u")};switch(t.service){case"TenantSetupManagement":e.tenantDefaultService.uploadIn(t.save,n).subscribe(function(e){0===e?h.a.fire("Failed!","Transaction failed!","error"):h.a.fire("Ok!","Transaction successful!","success")},function(e){console.log(e.error),h.a.fire("Failed!","Transaction failed!","error")});break;case"UserManagement":e.userManagementService.uploadIn(t.save,n).subscribe(function(e){0===e?h.a.fire("Failed!","Transaction failed!","error"):h.a.fire("Ok!","Transaction successful!","success")},function(e){console.log(e.error),h.a.fire("Failed!","Transaction failed!","error")});break;case"FilingManagement":e.filingManagementService.uploadIn(t.save,n).subscribe(function(e){0===e?h.a.fire("Failed!","Transaction failed!","error"):h.a.fire("Ok!","Transaction successful!","success")},function(e){console.log(e.error),h.a.fire("Failed!","Transaction failed!","error")})}}})})}}])&&t(a.prototype,r),i&&t(a,i),n}(),F.\u0275fac=function(e){return new(e||F)(g.Lb(v.a),g.Lb(m.a),g.Lb(p.c),g.Lb(p.b),g.Lb(y.a),g.Lb(w.a),g.Lb(I.a))},F.\u0275cmp=g.Fb({type:F,selectors:[["app-uploader"]],decls:2,vars:2,consts:[["class","spinner-wrapper",4,"ngIf"],["class","animate__animated animate__fadeInUp",4,"ngIf"],[1,"spinner-wrapper"],[1,"spinner"],[1,"animate__animated","animate__fadeInUp"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-3"],[1,"form-group"],[1,"control-label"],["name","industry","bindLabel","data_upload_name","bindValue","data_upload_id","placeholder","Select Data Upload",3,"items","ngModel","ngModelChange","change"],[1,"col-md-5"],["placeholder","Choose file","type","file","name","img[]","id","fileUploadInputExample",1,"file-upload-default",3,"change"],["file",""],[1,"input-group","col-xs-12",3,"click"],["type","text","disabled","","placeholder","Upload Log",1,"form-control","file-upload-info"],[1,"input-group-append"],["type","button",1,"file-upload-browse","btn","btn-primary","btn-icon-text"],["data-feather","upload","appFeatherIcon","",1,"btn-icon-prepend"],["class","progress",4,"ngIf"],[1,"col-md-4"],["type","button",1,"btn","btn-primary","btn-icon-text",3,"click"],["data-feather","download","appFeatherIcon","",1,"btn-icon-prepend"],[1,"btn","btn-primary","btn-icon-text",3,"click"],["data-feather","save","appFeatherIcon","",1,"btn-icon-prepend"],[1,"table-responsive"],[1,"text-danger","mt-1"],["id","dataTableExample","class","table table-bordered",4,"ngIf"],[1,"progress"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar"],["id","dataTableExample",1,"table","table-bordered"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngClass"]],template:function(e,t){1&e&&(g.Gc(0,R,3,0,"div",0),g.Gc(1,M,43,5,"div",1)),2&e&&(g.jc("ngIf",t.isLoading),g.yb(1),g.jc("ngIf",!t.isLoading))},directives:[i.n,u.a,c.i,c.l,O.a,i.m,i.l],styles:[".has_error[_ngcontent-%COMP%]{background-color:#9acd32}"]}),F)}]}],j=((D=function t(){e(this,t)}).\u0275mod=g.Jb({type:D}),D.\u0275inj=g.Ib({factory:function(e){return new(e||D)},imports:[[i.c,c.f,c.p,s.g.forChild(U),l.a,u.b,d.b]]}),D)},njyG:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var a=n("fXoL"),r=function(){function e(e){this.el=e,this.dtOptions={}}return e.prototype.ngOnInit=function(){var e=this;this.dtTrigger?this.dtTrigger.subscribe(function(){e.displayTable()}):this.displayTable()},e.prototype.ngOnDestroy=function(){this.dtTrigger&&this.dtTrigger.unsubscribe(),this.dt&&this.dt.destroy(!0)},e.prototype.displayTable=function(){var e=this;this.dtInstance=new Promise(function(t,n){Promise.resolve(e.dtOptions).then(function(n){setTimeout(function(){var a={rowCallback:function(t,a,r){if(n.columns){var i=n.columns;i.filter(function(e){return e.ngPipeInstance}).forEach(function(e){var n=e.ngPipeInstance,a=i.findIndex(function(t){return t.data==e.data}),r=t.childNodes.item(a),o=$(r).text(),c=n.transform(o);$(r).text(c)})}e.dtOptions.rowCallback&&e.dtOptions.rowCallback(t,a,r)}};a=Object.assign({},n,a),e.dt=$(e.el.nativeElement).DataTable(a),t(e.dt)})})})},e.\u0275fac=function(t){return new(t||e)(a.Lb(a.l))},e.\u0275dir=a.Gb({type:e,selectors:[["","datatable",""]],inputs:{dtOptions:"dtOptions",dtTrigger:"dtTrigger"}}),e}(),i=n("ofXK"),o=function(){function e(){}return e.forRoot=function(){return{ngModule:e}},e.\u0275mod=a.Jb({type:e}),e.\u0275inj=a.Ib({factory:function(t){return new(t||e)},imports:[[i.c]]}),e}()}}])}();