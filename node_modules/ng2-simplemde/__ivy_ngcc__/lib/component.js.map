{"version":3,"file":"component.js","sources":["../src/component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n  Component,\r\n  NgModule,\r\n  forwardRef,\r\n  ElementRef,\r\n  ViewChild,\r\n  AfterViewInit,\r\n  Input,\r\n  OnDestroy,\r\n  ModuleWithProviders,\r\n  Inject\r\n} from '@angular/core'\r\nimport {\r\n  NG_VALUE_ACCESSOR\r\n} from '@angular/forms'\r\nimport { CommonModule } from '@angular/common'\r\nimport { FormsModule } from '@angular/forms'\r\nimport { NgModelBase } from './utils'\r\nimport { SIMPLEMDE_CONFIG } from './config'\r\nimport * as SimpleMDE from 'simplemde'\r\n\r\nconst SIMPLEMDE_CONTROL_VALUE_ACCESSOR: any = {\r\n  provide: NG_VALUE_ACCESSOR,\r\n  useExisting: forwardRef(() => Simplemde),\r\n  multi: true\r\n}\r\n\r\n@Component({\r\n  selector: 'simplemde',\r\n  template: `\r\n    <textarea #simplemde></textarea>\r\n  `,\r\n  providers: [\r\n    SIMPLEMDE_CONTROL_VALUE_ACCESSOR\r\n  ]\r\n})\r\nexport class Simplemde extends NgModelBase implements AfterViewInit, OnDestroy {\r\n  @ViewChild('simplemde') textarea: ElementRef\r\n  @Input() options: SimpleMDE.Options = {}\r\n  @Input() codemirror: any = {}\r\n\r\n  private simplemde: SimpleMDE\r\n  private tmpValue = null\r\n\r\n  writeValue(v: any) {\r\n    if (v !== this._innerValue) {\r\n      this._innerValue = v\r\n      if (this.simplemde && this.value != null) {\r\n        this.simplemde.value(this.value)\r\n      }\r\n      if (!this.simplemde) {\r\n        this.tmpValue = this.value\r\n      }\r\n    }\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    if (typeof this.config !== 'object' || typeof this.options !== 'object') {\r\n      throw 'config is not an object'\r\n    }\r\n\r\n    const config = { ...this.config, ...this.options }\r\n    config.element = this.textarea.nativeElement\r\n\r\n    this.simplemde = new SimpleMDE(config)\r\n    Object.keys(this.codemirror).forEach((k) => {\r\n      this.simplemde.codemirror.setOption(k, this.codemirror[k])\r\n    })\r\n\r\n    if (this.tmpValue) {\r\n      this.simplemde.value(this.tmpValue)\r\n      this.tmpValue = null\r\n    }\r\n\r\n    this.simplemde.codemirror.on('change', () => {\r\n      this.value = this.simplemde.value()\r\n    })\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.simplemde = null\r\n  }\r\n\r\n  constructor(\r\n    @Inject(SIMPLEMDE_CONFIG) private config\r\n  ) {\r\n    super()\r\n  }\r\n\r\n}\r\n\r\n@NgModule({\r\n  declarations: [\r\n    Simplemde\r\n  ],\r\n  imports: [\r\n    FormsModule,\r\n    CommonModule\r\n  ],\r\n  exports: [\r\n    Simplemde,\r\n    FormsModule,\r\n    CommonModule\r\n  ]\r\n})\r\nexport class SimplemdeModule {\r\n  static forRoot(configProvider: any = {\r\n    provide: SIMPLEMDE_CONFIG,\r\n    useValue: {}\r\n  }): ModuleWithProviders {\r\n    return {\r\n      ngModule: SimplemdeModule,\r\n      providers: [\r\n        configProvider\r\n      ]\r\n    }\r\n  }\r\n}\r\n"]}